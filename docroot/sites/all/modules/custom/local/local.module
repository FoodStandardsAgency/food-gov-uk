<?php

/**
 * Implements hook_form_alter().
 */
function local_form_news_node_form_alter(&$form, &$form_state, $form_id) {

  // Remove the 'England' option from Primary Nation selector on News content type, because there is no England section.
  $options = array();

  foreach ($form['field_primary_nation'][LANGUAGE_NONE]['#options'] as $key => $value) {
    if ($value != 'England') {
      $options[$key] = $value;
    }
  }

  $form['field_primary_nation'][LANGUAGE_NONE]['#options'] = $options;
}

/**
 * Implements hook_theme_registry_alter().
 */
function local_theme_registry_alter(&$theme_registry) {

  // Hide specific items in the main menu, so they don't display on the Primary Menu.
  // Add our override function, which will adjust the variables then pass them through the original function.
  if (isset($theme_registry['superfish_build'])) {
    $theme_registry['superfish_build']['function'] = 'theme_local_superfish_build';
  }
}

/**
 *  Adjust the Superfish main menu.
 *  Hide specific items in the main menu, so they don't display on the Primary Menu.
 **/
function theme_local_superfish_build($variables) {

  // Links to be hidden on Main Menu.
  // Specify which links should be Visible in the main menu
  $show_links = array(
    'Home',
    'News & updates',
    'Business & industry',
    'Enforcement & regulation',
    'Science & policy',
    'About us'
  );

  foreach ($variables['menu'] as $key => $menu_item) {
    if (!in_array($menu_item['link']['title'], $show_links)) {
      unset($variables['menu'][$key]);
    }
  }

  $output = theme_superfish_build($variables);
  return $output;
}
function local_form_alter(&$form, &$form_state, $form_id){
  $id = $form_id;
}

/**
 * Quick form alter to give the search forms their own unique submit button ids that do not clash with the overlay
 * @param $form
 * @param $form_state
 */
function local_form_search_block_form_alter(&$form, &$form_state, $form_id){
  $form['actions']['submit']['#id'] = drupal_html_id('submit-search_block_form');
}

/**
 * Implements hook_node_view().
 */
function local_node_view($node, $view_mode, $langcode) {
  // FAQ accordion effect.
  if ($node->type == 'faq' && $view_mode == 'full') {
    drupal_add_library('system','ui.accordion');
    drupal_add_js(drupal_get_path('module', 'local') . '/js/local.js');
  }
}



